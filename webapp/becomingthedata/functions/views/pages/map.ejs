<!DOCTYPE html>
<html>
    <head>
        <title>Atlanta Map | GT Dataseum</title>
        <%- include('../includes/head'); %>
        <link rel="stylesheet" type="text/css" media="screen" href="/css/map.css">
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
            integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
            crossorigin=""/>
            <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
                integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
                crossorigin="">
            </script>
    </head>

    <body>
        <div class="logo">
            <img src="/img/transparent_logo.svg" alt="Logo">
        </div>
        <div id="content full">
            <div id="map"></div>
        </div>

        <script>
            var dotMarkers = [];
            var map;
           document.addEventListener('DOMContentLoaded', function () {
            map = L.map('map').setView([33.749, -84.388], 13); // Atlanta coordinates
            
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: 'Â© OpenStreetMap contributors'
            }).addTo(map);

            // dots
            <% dots.forEach(dot => { %>
                var dotMarker = L.circleMarker([<%= dot.longitude %>, <%= dot.latitude %>], {
                    color: '#<%= dot.colorHex %>',
                    fillColor: '#<%= dot.colorHex %>',
                    fillOpacity: 1,
                    radius: 8
                }).addTo(map);

                dotMarker.bindPopup(`
                    <img src="/img/personalities/<%= dot.group %>.png" style="width: 100%; height: auto">
                    <p>Creation Date: ${new Date(<%= dot.timestamp %>).toLocaleString()}</p>
                `);

                dotMarkers.push(dotMarker);
            <% }); %>
        });
    
        </script>
        <script src="/js/map.js"></script>
    </body>
</html>